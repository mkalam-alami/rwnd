config:
    gameId: redSpadeFr 
    start: 10
    persistFlags: true
    
steps: 

# First scene

    10:
        text: |
            J'arrive face au manoir, caché par l'obscurité. Une lumière chaude s'échappe de l'entrée, accompagnée du bruit de conversations et de verres qui s'entrechoquent.
            Un réceptionniste se tient devant la porte.
        links:
            20:
                ifNotFlag: redFollowsMe
                text: S'approcher
     
    20:
        text: |
            {{^redShotMe}}{{^redFollowsMe}}Le jeune employé, rongé par l'ennui en cette fin de soirée, sourit en me voyant. Je me présente avec enthousiasme :
            « Bonsoir cher ami ! Je suis attendu sous le nom de... »{{/redFollowsMe}}{{#redFollowsMe}}J'approche du manoir, mais le réceptionniste n'est autre que Red Spade. Il agite son arme en me narguant :
            « Tu as joué et perdu, cher ami. Bientôt, la construction de ma bombe temporelle s'achèvera, et je figerai ton pays dans le temps pour une centaine d'années ! Et tout ça... grâce à ceci. » Il brandit une vieille montre à gousset, en tout point identique à la mienne.
            « Après avoir été figée dans le temps, ta civilisation sera complètement dépassée, et vos anciennes technologies ne feront pas le poids lorsque je viendrai vous envahir ! »
            Il éclate d'un rire mauvais.{{/redFollowsMe}}{{/redShotMe}}{{#redShotMe}}J'aspire un grand bol d'air : je vis ! Je tâte ma poitrine machinalement, la blessure a bien disparu. C'est psychologique, mais j'ai besoin de quelques secondes pour retrouver mon souffle.
            
            J'aperçois Red qui guette toujours l'entrée du manoir.{{/redShotMe}}
        links:
            21:
                ifNotFlag: redFollowsMe
                text: Red Club
            22:
                ifNotFlag: redFollowsMe
                text: Black Heart
            23:
                text: Je ne me souviens plus
                ifNotFlag: boris
            70:
                text: Boris Rosing
                ifNotFlag: redFollowsMe
                ifFlag: boris
            400:
                ifFlag: redFollowsMe
                text: Se jeter sur lui
            410:
                ifFlag: redShotMe
                text: Le contourner par sa gauche
    
    400:
        setFlag: redShotMe
        text: |
            Tout en écoutant son discours, je me suis lentement approché de lui. Dans un effort désespéré, je me jette en avant pour écarter son bras armé tout en le plaquant au sol.
            
            Malheureusement, il est le plus rapide, et son revolver tire.
            
            C'est étrange... L'espace d'un instant, tout en m'écroulant vers le sol, je remarque que son œil gauche paraît anormal... Amorphe... Aurait-il un œil de verre ? Je ne m'en étais jamais rendu compte jusqu'à maintenant, et pourtant je connais Red Spade depuis plus de dix ans.
            
            Je suis maintenant allongé sur le dos, et une douleur sourde compresse ma poitrine. Je relève la tête vers mon torse et aperçois une corolle pourpre s'agrandir sur ma chemise. Ma vision se fait floue... Je tente une dernière fois de me concentrer.
    
    410:
        text: Je m'applique à faire un détour silencieux, profitant de l'angle mort laissé par l'œil de verre de Red. Je me retrouve bientôt derrière lui, mon couteau à la main, et remarque dans sa poche arrière la fameuse montre, dont la chaîne pend sur quelques centimètres.
            
        links:
            420: Neutraliser Red Spade
            
    420:
        #disableRewindTo: 420
        text: |
            Dans un même mouvement, je lance la montre de Red hors de sa portée, et l'immobilise d'une clef de bras, le couteau sous sa gorge. Une fois passée la surprise, Red lâche d'une voix étranglée :
            « Joli coup, mais ce n'est pas fini ! »
            Il tend son bras libre vers sa poche arrière, sans doute pour utiliser sa montre maintenant absente. Red perd tout à coup de sa superbe. Je resserre un peu plus mon étreinte.
            
            
            Quelques minutes plus tard, je tiens enfin en main l'objet de ma mission. Tout le nécessaire pour construire une arme capable d'arrêter le temps... Tant de pouvoir ne doit pas atterir entre de mauvaises mains.
            
            
            Je m'approche de la cheminée et hésite un moment, sur le point de trahir mes ordres de mission. D'un geste brusque, je lance les documents au milieu des flammes. L'ancienne montre à gousset de Red la suit de peu, qui éclate immédiatement en une gerbe d'étincelles multicolores.
            Je saisis alors entre mes mains ma propre montre, dernier exemplaire d'une ancienne technologie longtemps perdue. Dois-je jeter ce pouvoir dans le feu ? Le détruire pour toujours ?
            
            
            J'hésite un instant, puis un sourire en coin me saisit, et je me détourne des flammes.
            
            
            *FIN*
            
    21:
        removeFlag: heart
        continue: 30
    22:
        setFlag: heart
        continue: 30
    
    23:
        text: |
            « Je suis désolé Monsieur, il me faut un nom pour vous laisser entrer. »
            Simple contretemps.
        links:
            40: Sortir la vieille montre à gousset
        
    30:
        text: |
            L'employé me tourne le dos pour parcourir sa liste, {{^redFollowsMe}}puis se retourne vers moi d'un air désolé. 
            « Veuillez m'excuser, mais je ne trouve pas votre nom... »
            « Vous êtes sûr ? Vous avez bien cherché {{#heart}}Black Heart{{/heart}}{{^heart}}Red Club{{/heart}} ? »
            « Je suis désolé M'sieur, votre nom n'est pas sur la liste. »
            Simple contretemps.{{/redFollowsMe}}{{#redFollowsMe}}puis une arme tire, le jeune homme s'écroule.
            Derrière lui, Red pointe son arme vers moi.{{/redFollowsMe}}
        links:
            40: 
                ifNotFlag: redFollowsMe
                text: Sortir la vieille montre à gousset
    
    40:
        text: |
            « Vous voyez cette ancienne montre ? Derrière cette technologie dépassée se cache une magie incroyable. »
            Le réceptionniste paraît amusé. « Quel genre de magie ? »
            « Cet appareil me permet de remonter le temps. D'explorer des branches parallèles de l'espace-temps. Et par conséquent d'accéder à un savoir infini. »
            « Euh, je ne vois pas le lien entre... remonter le temps et... le savoir infini. »
            « Peu importe ! Voyez plutôt : je m'apprête à deviner ce que vous avez dans votre poche intérieure droite. »
        links:
            50: Faire mine de se concentrer
            51: Murmurer des incantations
            
    50:
        continue: 51
    51: 
        disableRewindTo: 51
        text: |
            L'employé me nargue, un sourire en coin :
            « Alors ? Qu'est-ce que j'ai dans ma veste ? »
        links:
            51bis: Je sais ce que c'est !
    51bis: 
        text: « Il s'agit...  »
        links:
            52: D'un mouchoir
            54: D'un paquet de cigarattes
            53: D'un trousseau de clefs
            60:
                ifFlag: 100dollars
                text: D'un pourboire
                
    52:
        continue: 55
    53:
        continue: 55
    54:
        continue: 55
    55:
        setFlag: 100dollars
        text: |
            « Haha bien essayé ! »
            « Dommage, » fais-je avec humilité. « C'était quoi ? »
            « Vous ne valez pas grand-chose comme magicien ! C'était un pourboire de cent dollars », lance-t-il fièrement.
            « C'est tout ce que voulais savoir. »
            Sous son regard perplexe, je lève lentement ma montre à gousset, et me concentre sur un point dans le passé...
            
    60:
        setFlag: boris
        disableRewindTo: '-'
        text: |
            Je sors un portefeuille de ma poche arrière, puis d'un geste théâtral, en dégaîne un billet de cent dollars. Le réceptionniste fait les grands yeux, et se retourne le temps de vérifier sa poche.
            
            J'en profite pour le contourner et m'approcher de la liste des invités. J'ai tout juste le temps de lire un nom : Boris Rosing.
            
            « Vous avez bien failli m'av— eh qu'est-ce que vous faites ? »
            Je me concentre à nouveau.
            
    70: 
        text: |
            L'employé me tourne le dos pour parcourir sa liste, {{^redFollowsMe}}puis se retourne vers moi et fait une petite courbette. 
            « Je vous souhaite la bienvenue, Monsieur Rosing. C'est un plaisir de vous avoir parmi nous ce soir. »{{/redFollowsMe}}{{#redFollowsMe}}puis une arme tire, le jeune homme s'écroule.
            Derrière lui, Red pointe son arme vers moi.{{/redFollowsMe}}
        links:
            100:
                ifNotFlag: redFollowsMe
                text: Entrer dans le bâtiment
            300:
                ifFlag: windowsUnlocked
                ifNotFlag: redFollowsMe
                text: Grimper par la fenêtre du salon
            
            
            
# Second scene
            
    100:
        text: |
            J'entre dans une grande salle luxueusment décorée, où des hommes en costume et femmes en robe de soirée discutent par petits groupes, un verre de champagne à la main. Un buffet appétissant occupe tout un mur de la pièce.
            
            Il me faut un instant avant de repérer un escalier au fond de la salle, en partie masqué par un imposant lustre.
            Le bureau doit être à l'étage.
        links:
            110: Monter l'escalier
            105: Examiner les invités
    
    105:
        removeFlag: agentFollowedMe
        text: Je repère parmi la foule ce qui semble être un agent de sécurité. En faisant attention, je devrais pouvoir atteindre l'escalier sans l'attirer.
        links:
            120: Monter l'escalier

    110:
        removeFlag: hasKey
        setFlag: agentFollowedMe
        text: |
            Sans que les invités ne me prêtent attention, je me faufile entre les invités jusqu'à l'escalier du fond.
            
            Une fois parvenu à l'étage, je jette un regard sous la rembarde : quelqu'un se trouve en bas de l'escalier. J'ai l'impression d'avoir été suivi.
        links: 
            130: Examiner l'étage
            115: Redescendre confronter l'intrus
    
    115:
        text: |
            De peur d'avoir attiré l'attention, je redescends l'air de rien l'escalier... Pour me trouver face à face avec un homme froid aux épaules carrées. Je lui souris :
            « Veuillez m'excuser, je cherchais les toilettes et— »
            Avec une vitesse surprenante, le garde me plaque contre le mur, une main sur la bouche. Une douleur déchirante traverse mon ventre, et je m'apprête à perdre connaissance...
            
    120:
        removeFlag: hasKey
        text: |
            Sans que personne ne semble me prêter attention, je me faufile entre les invités jusqu'à l'escalier du fond.
            Une fois parvenu à l'étage, je jette un regard sous la rembarde : le garde ne m'a pas suivi.
        links:
            130: Examiner l'étage
            
    140:
        removeFlag: hasKey
        text: "Je retourne dans le couloir, puis m'arrête subitement : quelqu'un vient de monter l'escalier. Un agent de sécurité me jauge d'un regard froid, puis s'approche lentement vers moi."
        links:
            145: Fuir
            146: Combattre
            
    145:
        text: |
            Je m'enferme dans la pièce la plus proche, et me retrouve dans l'obscurité. J'entends des voix à l'extérieur, et distingue sous la porte une lumière qui s'échappe et des formes qui s'agitent.
            « Je crois que je suis fichu, » dis-je à moi-même.
            
            Quelqu'un défonce bruyamment la porte d'un coup de pied et trois agents m'encerclent, armés jusqu'aux dents. Ne restons pas pour la suite.
    
    146:
        text: |
            Je sors un couteau de ma veste. Simultanément, l'agent dégaine un revolver, me met en joue et...
            D'instinct, je ferme les yeux et me concentre.
    
    130:
        setFlag: corridorVisited
        text: Le couloir part à gauche et à droite, avec{{^corridorVisited}}, mauvaise nouvelle,{{/corridorVisited}} pas moins de trois portes de chaque côté. Je n'ai pas pu avoir les plans à l'avance, il va falloir chercher le bureau au hasard.
        longLinks: true
        links:
            salle11: "Gauche, 1ère salle : fermée, une voix en sort"
            salle12: "Gauche, 2ème salle : fermée"
            salle13: "Gauche, 3ème salle : entrouverte, allumée"
            salle21: 
                ifNotFlag: bathroomChecked
                text: "Droite, 1ère salle : fermée"
            salleopen: 
                ifFlag: bathroomChecked
                text: "Droite, 1ère salle : fermée"
            salle22:
                ifNotFlag: hasKey
                text: "Droite, 2ème salle : fermée, a une porte double"
            salleopen2:
                ifFlag: hasKey
                text: "Droite, 2ème salle : fermée, a une porte double"
            salle23: "Droite, 3ème porte : fermée, un tapis posé devant"

    salleopen2:
        continue: salleopen
    salleopen:
        text: J'ai déjà fouillé cette pièce.
        links:
            130: Retourner dans le couloir
            
    salle11:
        text: J'entrouvre la porte avec précaution. Une radio est allumée à l'intérieur, mais personne ne s'y trouve. Une chambre de serviteur il semblerait.
        links:
            130:
                ifNotFlag: agentFollowedMe
                text: Retourner dans le couloir
            140:
                ifFlag: agentFollowedMe
                text: Retourner dans le couloir
    
    salle12:
        text: La porte s'ouvre sur un espace de rangement. Je n'y trouve rien d'intéressant.
        links:
            130:
                ifNotFlag: agentFollowedMe
                text: Retourner dans le couloir
            140:
                ifFlag: agentFollowedMe
                text: Retourner dans le couloir
                            
    salle13:
        text: Je m'approche et glisse mon regard à travers l'interstice, pour y repérer trois personnes armées, assises autour d'une table. La bonne nouvelle, c'est qu'il ne s'agit pas de la bonne pièce.
        links:
            130:
                ifNotFlag: agentFollowedMe
                text: Retourner dans le couloir
            140:
                ifFlag: agentFollowedMe
                text: Retourner dans le couloir
                
    salle21:
        text: La porte est fermée à clef. En essayant de l'ouvrir, le bruit de la porte a semblé résonner à l'intérieur.
        links:
            salle21b: Essayer de la crocheter
            salle21c:
                ifFlag: hasKey
                text: Utiliser la clef
            130:
                ifNotFlag: agentFollowedMe
                text: Retourner dans le couloir
            140:
                ifFlag: agentFollowedMe
                text: Retourner dans le couloir
            
    salle21b:
        setFlag: bathroomChecked
        text: Je sors un crochet de ma veste et ouvre rapidement la serrure. Une salle de bains.
        links:
            130:
                ifNotFlag: agentFollowedMe
                text: Retourner dans le couloir
            140:
                ifFlag: agentFollowedMe
                text: Retourner dans le couloir
        
    salle21c:
        text: La clef ne correspond pas.
        links:
            130:
                ifNotFlag: agentFollowedMe
                text: Retourner dans le couloir
            140:
                ifFlag: agentFollowedMe
                text: Retourner dans le couloir
            
                
    salle22:
        removeFlag: hasKey
        text: J'entre dans un grand salon, avec un billard à l'intérieur. Quelqu'un a laissé des clefs sur une chaise, je les ramasse en silence.
        links:
            salle22getkey:
                ifNotFlag: agentFollowedMe
                text: Retourner dans le couloir
            140:
                ifFlag: agentFollowedMe
                text: Retourner dans le couloir
    
    salle22getkey:
        setFlag: hasKey
        continue: 130
                
    salle23:
        text: La porte est fermée à clef.
        links:
            salle23b: Regarder sous le tapis
            salle23c: Essayer de la crocheter
            200:
                ifFlag: hasKey
                text: Utiliser la clef
            130:
                ifNotFlag: agentFollowedMe
                text: Retourner dans le couloir
            140:
                ifFlag: agentFollowedMe
                text: Retourner dans le couloir
    
    salle23b:
        text: Rien sous le tapis.
        links:
            salle23c: Essayer de la crocheter
            200:
                ifFlag: hasKey
                text: Utiliser la clef
            130:
                ifNotFlag: agentFollowedMe
                text: Retourner dans le couloir
            140:
                ifFlag: agentFollowedMe
                text: Retourner dans le couloir
    
    salle23c:
        text: Je sors un crochet de ma veste et tente d'ouvrir la serrure. Le modèle m'est inconnu... Il semble en fait que toute la porte ait été faite sur mesure. Je vais devoir trouver un autre moyen d'entrer.
        links:
            salle23b: Regarder sous le tapis
            200:
                ifFlag: hasKey
                text: Utiliser la clef
            130:
                ifNotFlag: agentFollowedMe
                text: Retourner dans le couloir
            140:
                ifFlag: agentFollowedMe
                text: Retourner dans le couloir

    200:
        disableRewindTo: 200
        text: |
            La clef correspond.
            
            La porte s'ouvre sur une grande salle doucement éclairée, imprégnée d'une odeur de tabac. Des livres recouvrent les murs, et un imposant bureau décoré avec élégance se trouve au fond de la pièce. Il n'y a personne dans la salle. 
        links:
            210: Fouiller la salle
            
    210:
        text: |
            A peine commencè-je mes recherches qu'un bruissement me force à me retourner : une bibliothèque s'est écartée du mur, et un homme élancé se tient dans l'encadrement, un dossier à la main.
            
            Je reconnais cette silhouette. Il s'agit de *Red Spade*, un... ancien collègue.
            
            Celui-ci s'avance dans la lumière, et rompt le silence d'un rire hautain :
            
            « {{#heart}}Black Heart{{/heart}}{{^heart}}Red Club{{/heart}}. Alors comme ça il t'ont envoyé ici ! Ils prennent mes projets très au sérieux apparemment... »
            « Red Spade. C'est donc toi qui es derrière la construction de cette arme. Je ne te laisserai pas faire ! »
            
            Des gardes armés entrent dans la pièce.
        links:
            215: Chercher une sortie
            216: Ne rien faire
            
    215: 
        text: Je me retourne brièvement. La fenêtre est ouverte, mais trop haute pour tenter le plongeon.
        continue: 216
    
    216:
        disableRewindTo: '-'
        setFlag: windowsUnlocked
        text: |
            Tandis que les agents s'approchent de moi, Red Spade me montre sa chemise de documents :
            
            « C'est ça que tu es venu chercher, n'est-ce pas ? Quel dommage, tu étais si près du but ! »
            « Oh ne t'inquiète pas pour moi, » fais-je avec un sourire poli.
            
            Je devrais pouvoir revenir au bureau par un autre moyen, plus rapide. Peut-être une fenêtre ?

# Third scene

    300: 
        text: |
            {{^redFollowsMe}}Une fois trompée la vigilance du réceptionniste, je me mets à longer le mur extérieur dans l'obscurité.
            Je repère la fenêtre du salon, délace mes chaussures, puis me mets à grimper à l'aide des reliefs du mur.
            Je rejoins rapidement le bureau, dont la fenêtre est par chance toujours (...déjà ?) ouverte.{{/redFollowsMe}}{{#redFollowsMe}}Je cours me placer sous la fenêtre du salon, lorsque retentit un coup de feu. Un morceau de mur éclate à quelques centimètres de moi.
            
            Je me retourne, et à la place du réceptionniste se tient un Red au sourire terrible, l'arme pointée sur moi.
            « Tu ne m'échapperas pas ! » me crie-t-il.
            
            Aurait-il le même pouvoir que moi ? Comment le combattre ? Je dois revenir plus tôt !{{/redFollowsMe}}
        links:
            305:
                ifNotFlag: redFollowsMe
                text: Fouiller le bureau
            310:
                ifNotFlag: redFollowsMe
                text: Essayer d'ouvrir le passage secret
             
    305:
        text: |
            Je parcours la pièce rapidement sans rien trouver d'utile. De toutes manières, les informations que je recherche sont derrière ce passage.
            
            Pour gagner quelques précieux instants, je me concentre pour revenir quelques instants en arrière.
    310:
        text: |
            Je parcours mes mains sur la bibliothèque à la recherche d'une ouverture, et finis par remarquer une fente dans le fond du meuble, entre deux livres. Je sors mon couteau cran, le déplie et insère la pointe dans l'ouverture.
            Un déclic se fait entendre.
        links:
            320: Entrer dans la salle secrète
            
    320:
        disableRewindTo: '-'
        setFlag: redFollowsMe
        text: |
            Le meuble cède le passage en silence. Je m'engage dans l'ouverture... et me retrouve nez-à-nez avec Red Spade.
            « Tu es trop lent ! » s'exclame-t-il, brandissant une lame.
            Comment est-ce possible ? Je dois réessayer. Peut-être grimper de nouveau, cette fois plus rapidement ?
